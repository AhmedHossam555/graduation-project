

<div class="px-4 py-6">
  <h2 class="text-2xl font-bold py-5 border-b border-gray-100 mb-8">BackLog</h2>

  


  <!-- Sprint List -->
  <div id="sprint-list" class="mb-10">
    @for (sprint of sprintTasks; track  $index) {
      <div class="bg-[#f8f8f8] shadow py-3 px-2 mb-2 rounded ">
        <!-- Header -->
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-medium mb-2">{{sprint.title}} <span class="text-sm  text-gray-500 pl-3">{{sprint.startDate}} â€“ {{sprint.endDate}} &nbsp; ({{sprint['sprint-tasks'].length}} issue)</span></h2>
        <div class="inline-flex items-center gap-2">
          @if(!sprint.sprintStart){
            <button   [disabled]="$index > 0" 
              [ngClass]="{'bg-blue-600 hover:bg-blue-700 cursor-pointer': $index === 0,
              'bg-gray-300 cursor-not-allowed': $index > 0}" 
              class="px-4 py-1 cursor-pointer border bg-blue-600 rounded-md text-white font-medium hover:bg-blue-700 transition-all ease-in-out duration-300">
              Start sprint
            </button>
          }@else {
            <button class="px-4 py-1 cursor-pointer border border-gray-300 rounded-md text-gray-900 font-medium hover:bg-gray-100 hover:text-gray-800 transition-all ease-in-out duration-300">
              Complete Sprint
            </button>
          }
          <!-- Edit Button -->
          <div class="parent-edit relative">
            <button  [appEditButton]="'edit-button-'+$index"  class="inline-flex  self-center items-center cursor-pointer p-2 text-sm font-medium text-center text-gray-900 bg-gray-100 rounded hover:bg-gray-200   dark:text-white focus:ring-gray-50 dark:bg-gray-900 dark:hover:bg-gray-800 " type="button">
              <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4 text-gray-700"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
           </button>
           <div [id]="'edit-button-'+$index" class="absolute hidden right-0  mt-2 w-40 origin-top-right rounded-md  bg-white shadow">
            <div class="py-1">
              <a data-modal-target="update-sprint-modal" data-modal-toggle="update-sprint-modal"  (click)="updateSprintItem(sprint)" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 edit">Edit sprint</a>
              <a  class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 edit" >Delete sprint</a>
            </div>
          </div>
          </div>
        </div>
  
        
      </div>
      <!-- body sprint -->
      <div (drop)="onDrop($event,$index)" (dragover)="onDragOver($event)" class="body-sprint bg-white  main-border rounded-sm">
        @for(item of sprint['sprint-tasks']; track $index){
          <div draggable="true" (dragstart)="onDragStart(item)" class="item-task-sprint flex items-center justify-between hover:bg-gray-100 cursor-move p-3 ">
            <div class="flex items-center gap-2">
              <div class="w-4 h-4 bg-green-500 rounded-sm"></div>
              <span class="font-medium">{{item.title}}</span>
            </div>
            <span class="text-gray-400 text-sm">{{item.id+'DSL'}}</span>
          </div>
        }
      <div class="input-sprint-issue">
        <input type="text" [id]="sprint.id+'DSL'" (keyup)="addTaskToSprintHandler($event,$index)"  class="hidden backlog-input w-full   p-3  text-sm border-0   font-normal text-main-label focus:border-transparent"  [(ngModel)]="sprintTaskValue" placeholder=" What needs to be done?">
      </div>
      </div>
    
      <div class="p-3 hover:bg-gray-100 cursor-pointer"  [appShowInput]="sprint.id+'DSL'" >
        <button class="text-blue-600 cursor-pointer text-sm font-semibold" >+ Create issue</button>
      </div>
    
    </div>
    }
  
  </div>











  <!----------------- Backlog List ---------------- -->
  <div id="backlog-list" class="mb-6">
    <div class="bg-[#f8f8f8] shadow py-3 px-2 mb-2 rounded ">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-medium mb-2">Backlog <span class="text-sm  text-gray-500">({{backlogTasks.length}} issue)</span></h2>
        <button (click)="onCreateSprint()" class="px-4 py-1 border border-gray-300 rounded-md text-gray-900 font-medium hover:bg-gray-100 hover:text-gray-800 transition-all ease-in-out duration-300">
          Create sprint
        </button>
      </div>
      <!-- body backlog -->
      <div (drop)="onDrop($event, 0)" (dragover)="onDragOver($event)" class="body-backlog bg-white  main-border rounded-sm">
        @for(item of backlogTasks; track $index){
          <div draggable="true" (dragstart)="onDragStart(item)" class="item-task-backlog gap-10 flex items-center justify-between hover:bg-gray-100 cursor-move p-3 ">
            <div class="flex items-center gap-2 flex-1">
              <div class="w-4 h-4 bg-green-500 rounded-sm"></div>
              <span class="font-medium">{{item.title}}</span>
            </div>
              <!-- Dropdown container -->
            <div class="relative inline-block text-left mr-2">
              <!-- Trigger button -->
              <button
              [appDropdownStatus]="'edit-status' + $index"
              [ngClass]="{
                  'bg-blue-200 text-blue-800': item.status == 'In-progress',
                'bg-gray-300 text-gray-800': item.status == 'To-do',
              
                'bg-lime-300 text-green-800': item.status == 'Done'
              }"
              class="inline-flex justify-center items-center text-sm uppercase font-medium px-3 py-1 rounded"
            >
              {{ item.status }}
              <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
              </svg>
            </button>

              <!-- Dropdown menu -->
              <div [id]="'edit-status'+$index"  class="absolute hidden py-1 mt-2 w-48 rounded-md shadow-lg bg-white z-10">
                  @if(item.status != 'To-do'){
                    <div class="flex items-center px-4 py-2 hover:bg-gray-100 cursor-pointer status" (click)="updateTaskStatus($event,item, 'To-do')">
                      <span class="bg-gray-300 text-gray-800 text-xs font-semibold px-2 py-0.5 rounded status" >TO DO</span>
                    </div>  
                  }
                  @if(item.status != 'In-progress'){
                    <div class="flex items-center px-4 py-2 hover:bg-gray-100 cursor-pointer status" (click)="updateTaskStatus($event,item, 'In-progress')">
                      <span class="bg-blue-200 text-blue-800 text-xs font-bold px-2 py-0.5 rounded status" >
                        IN PROGRESS
                      </span>
                    </div>

                  }
                  @if(item.status != 'Done'){
                    <div class="flex items-center px-4 py-2 hover:bg-gray-100 cursor-pointer status" (click)="updateTaskStatus($event,item, 'Done')">
                      <span class="bg-lime-300 text-green-800 text-xs font-semibold px-2 py-0.5 rounded status" >DONE</span>
                    </div>
                  }
              
                
                  <!-- <div class="border-t border-gray-100 my-1"></div>
                  <div class="px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer">
                    View workflow
                  </div> -->
                
              </div>
            </div>
            <span class="text-gray-400 text-sm">{{item.id}}</span>
          </div>
        }
      <div>
        @if (isVisibleCreateIssue ) {
          <input type="text" id="backlog-value" (keyup)="addTaskToBacklogHandler($event)"  class="block backlog-input w-full   p-3  text-sm border-0   font-normal text-main-label focus:border-transparent"  [(ngModel)]="backlogVlaue" placeholder=" What needs to be done?">
        }
      </div>
    
      </div>
      @if(!isVisibleCreateIssue){
        <div class="p-3 hover:bg-gray-100 cursor-pointer" (click)="addTaskToBacklog()" >
          <button class="text-blue-600 cursor-pointer text-sm font-semibold">+ Create issue</button>
        </div>
    }
    
    </div>
  </div>
</div>












